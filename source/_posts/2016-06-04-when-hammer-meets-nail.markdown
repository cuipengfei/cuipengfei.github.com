---
layout: post
title: "当锤子遇到钉子"
date: 2016-06-04 16:58
comments: true
categories: 
---

<sub>此文标题党。更切题的标题应该叫做《如何用统计科学来黑星座》或者是《积极注册Facehub,促进统计科学蓬勃发展》 </sub>

# 锤子　JS Promise

最近对JS社区里的Promises/A+规范产生了很浓的兴趣,感觉Promise这套东西确实蛮不错的,给异步算法的编写者和异步算法的消费者之间提供了一套统一的沟通手段,也为异步算法的消费者提供了更悦目易读的代码组织方式。

自己把它实现了一遍:[https://www.npmjs.com/package/RWPromise](https://www.npmjs.com/package/RWPromise)

然后在武汉run了3次workshop:[http://cuipengfei.me/blog/2016/05/15/promise/](http://cuipengfei.me/blog/2016/05/15/promise/)。

手里有了这么一把锤子就总想找个钉子敲一敲。哪里有Ｎ多异步操作需要我来组织一下吗?

# 钉子　《异类》

无巧不成书,刚好最近在豆瓣上买了一本叫做《异类》的书在看:　[https://read.douban.com/ebook/10580943/](https://read.douban.com/ebook/10580943/)

书中一开篇就提到了关于加拿大冰球运动员选拔机制的很有趣的一件事:

> 职业青年队绝大多数球员的生日集中在1月、2月和3月，这实在有点不可思议

>加拿大冰球队按年龄分组所依据的分界线是1月1日，即从1月1日到当年12月31日之间出生的球员将会被分在同一组。也就是说，一个1月1日出生的选手，是在跟许多年纪比他小的队友争夺晋级权——在青春期到来之前，由于有将近12个月的年龄差距，球员之间在生理成熟度上将会表现出巨大的差异。

>正如冰球队员的成长经历一样，因年龄大几个月而显现的微弱优势会在孩子的成长过程中不断积累，最终引导孩子走向成功或不成功，自信或不自信的轨道中，其影响会延伸许多年。

能否进入加拿大职业青年冰球队竟然和出生月份有关系,实在是太有趣了。

假想如果你运动天赋非常好,但是不幸出生在12月,于是不得不从小和大你将近一岁的少年运动员一起训练。
表现难免显得不那么出色,不受教练待见,得不到正面反馈,出场坐冷板凳。。。逐渐逐渐,伤仲永。

由此就联想到了,到TW来工作的人其出生月份是否也存在什么规律呢?

## Facehub

生日信息哪家强?
Facehub帮你忙,它可以查到每个注册用户的生日(只有月日,没有年)。

铺天盖地的广告宣传,每次看到觉得审美都疲劳了,能用到的时候第一个就想到了它。广告的作用,诚不我欺。

我先目测,Facehub用户不会超过500人。
并且用户的id是连续的自增数字,这就很好办了,我只要构造Ｎ多获取用户数据的ＧＥＴ请求就好了。
这Ｎ多的ＧＥＴ请求,肯定不能一个一个慢慢发送,那就需要异步请求了,这就是钉子啊!钉锤终于有机会合体了。

于是我就写了这么个脚本:　[https://github.com/cuipengfei/Spikes/blob/master/js/birth/birth.js](https://github.com/cuipengfei/Spikes/blob/master/js/birth/birth.js)

其中使用Promise把大量的异步Http请求组织起来,然后统计其结果。

(注:如果需要自己跑这个脚本,需要把第七行的token替换成你自己的合法值)

以下是统计结果:

```javascript
    获取到用户数量 318
    [ { '出生月份': '11', percentage: 11.949685534591195 },
      { '出生月份': '10', percentage: 11.635220125786164 },
      { '出生月份': '8', percentage: 10.062893081761008 },
      { '出生月份': '3', percentage: 8.80503144654088 },
      { '出生月份': '2', percentage: 8.49056603773585 },
      { '出生月份': '1', percentage: 8.176100628930817 },
      { '出生月份': '9', percentage: 7.861635220125786 },
      { '出生月份': '7', percentage: 7.232704402515723 },
      { '出生月份': '6', percentage: 7.232704402515723 },
      { '出生月份': '4', percentage: 7.232704402515723 },
      { '出生月份': '5', percentage: 5.9748427672955975 },
      { '出生月份': '12', percentage: 5.345911949685535 } ]
```

由此可以看到,来TW工作的人,11月,10月,8月出生的最多,12月出生的最少。

由于样本量不够大(只有318人),所以统计数据的含义还不太好说。

## 下面是我胡乱猜测的、不科学的、不严谨的理论
>我们小学入学时卡生日印象中是用8月卡的,那么这就和加拿大的冰球挑队员卡1月类似。

>那这样,小学入学后,优势的积累就应该会倾向于8,9,10这几月的学生(类比冰球青年职业队队员集中分布在1,2,3这几个月)。

>这几个月生日的小学生从小积累优势,并在成年后把优势携带到了求职之中去。

>那为什么我们统计出来是8,10,11月份的人份额多呢?怎么不是8,9,10这几个月呢?统计出来的数据为什么把9月给跳过去了呢?可怜的9月得罪谁了呢?

>我猜是由于9月这群人会成为某种星座的几率实在是太高了,被命运之神无情的给镇压掉了。:(抱歉

既然已经有了这份代码,可以统计出生月份,索性再统计些其他侧面的数据:

```javascript
    [ { '星座': '天秤', percentage: 11.949685534591195 },
      { '星座': '狮子', percentage: 10.377358490566039 },
      { '星座': '天蝎', percentage: 10.062893081761008 },
      { '星座': '双鱼', percentage: 9.433962264150944 },
      { '星座': '双子', percentage: 8.49056603773585 },
      { '星座': '水瓶', percentage: 8.49056603773585 },
      { '星座': '摩羯', percentage: 8.176100628930817 },
      { '星座': '巨蟹', percentage: 7.861635220125786 },
      { '星座': '处女', percentage: 6.918238993710692 },
      { '星座': '白羊', percentage: 6.918238993710692 },
      { '星座': '射手', percentage: 6.289308176100629 },
      { '星座': '金牛', percentage: 5.031446540880504 } ]
```

可见天秤和狮子座的最多,金牛座的最少。和上面的月份排名差异不大。

仔细看下的话,发现我只得罪了6.9%的人,好欣慰:)

```javascript
    [ { '入职月份': '7', percentage: 14.150943396226415 },
      { '入职月份': '4', percentage: 14.150943396226415 },
      { '入职月份': '8', percentage: 11.0062893081761 },
      { '入职月份': '3', percentage: 10.69182389937107 },
      { '入职月份': '6', percentage: 9.119496855345911 },
      { '入职月份': '5', percentage: 7.861635220125786 },
      { '入职月份': '12', percentage: 6.289308176100629 },
      { '入职月份': '2', percentage: 6.289308176100629 },
      { '入职月份': '1', percentage: 6.289308176100629 },
      { '入职月份': '11', percentage: 5.9748427672955975 },
      { '入职月份': '9', percentage: 4.40251572327044 },
      { '入职月份': '10', percentage: 3.7735849056603774 } ]
```

入职日期,3,4月和7,8月最多,9,10月最少,这倒不算什么惊人的发现。

#最后

由于只统计了318人的信息,所以以上猜测仅供娱乐,请勿当真。

请大家积极注册Facehub,并填写真实的生日信息,以促进统计科学的繁荣发展。