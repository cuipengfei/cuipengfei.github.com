---
title: 设计模式---观察者模式（恐怖袭击、地震的例子，有类关系图）
date: 2008-08-07 18:08:00
tags: 设计模式读书笔记
---
![设计模式---观察者模式（恐怖袭击、地震的例子，有类关系图）](https://p-blog.csdn.net/images/p_blog_csdn_net/cuipengfei1/EntryImages/20080807/ClassDiagram1.jpg)

  1. using  System;
  2. using  System.Collections.Generic;
  3. using  System.Text;
  4.   5. namespace  ConsoleApplication1
  6. {
  7. internal  interface  Warning
  8. {
  9. String Situation
  10. {
  11. get  ;
  12. set  ;
  13. }
  14.   15. void  Warn();
  16.   17. void  Add(PeopleInSchool p);
  18.   19. void  Sub(PeopleInSchool p);
  20. }
  21.   22. class  PoliceStation : Warning
  23. {
  24. private  IList<PeopleInSchool> field =  new  List<PeopleInSchool>();
  25. string  situation;
  26. public  string  Situation
  27. {
  28. get
  29. {
  30. return  situation;
  31. }
  32. set
  33. {
  34. situation = value;
  35. }
  36. }
  37.   38. public  void  Warn()
  39. {
  40. foreach  (PeopleInSchool p  in  field)
  41. {
  42. p.WarningReceived();
  43. }
  44. }
  45.   46. public  void  Add(PeopleInSchool p)
  47. {
  48. field.Add(p);
  49. }
  50.   51. public  void  Sub(PeopleInSchool p)
  52. {
  53. field.Remove(p);
  54. }
  55. }
  56.   57. class  EarthquakeDepartment : Warning
  58. {
  59.   60. string  situation;
  61.   62. private  IList<PeopleInSchool> field =  new  List<PeopleInSchool>();
  63.   64. public  string  Situation
  65. {
  66. get
  67. {
  68. return  situation;
  69. }
  70. set
  71. {
  72. situation = value;
  73. }
  74. }
  75.   76. public  void  Warn()
  77. {
  78. foreach  (PeopleInSchool p  in  field)
  79. {
  80. p.WarningReceived();
  81. }
  82. }
  83.   84. public  void  Add(PeopleInSchool p)
  85. {
  86. field.Add(p);
  87. }
  88.   89. public  void  Sub(PeopleInSchool p)
  90. {
  91. field.Remove(p);
  92. }
  93. }
  94.   95. abstract  class  PeopleInSchool
  96. {
  97.   98. protected  Warning field;
  99.   100. public  PeopleInSchool(Warning w)
  101. {
  102. field = w;
  103. }
  104.   105. public  abstract  void  WarningReceived();
  106.   107.   108. }
  109.   110. class  Teacher : PeopleInSchool
  111. {
  112. public  Teacher(Warning w)
  113. :  base  (w)
  114. {
  115.   116. }
  117.   118. public  override  void  WarningReceived()
  119. {
  120. Console.WriteLine(  "我是老师"  + field.Situation);
  121. }
  122. }
  123.   124. class  Student : PeopleInSchool
  125. {
  126. public  Student(Warning w)
  127. :  base  (w)
  128. {
  129.   130. }
  131.   132. public  override  void  WarningReceived()
  133. {
  134. Console.WriteLine(  "我是学生"  + field.Situation);
  135. }
  136. }
  137.   138. class  Client
  139. {
  140. public  static  void  Main()
  141. {
  142. PoliceStation p =  new  PoliceStation();
  143. Teacher t =  new  Teacher(p);
  144. Student s =  new  Student(p);
  145. p.Add(t);
  146. p.Add(s);
  147. p.Situation =  "有恐怖袭击！！！"  ;
  148. p.Warn();
  149. p.Situation =  "注意防火防盗！！！"  ;
  150. p.Warn();
  151.   152. EarthquakeDepartment e =  new  EarthquakeDepartment();
  153. t =  new  Teacher(e);
  154. s =  new  Student(e);
  155. e.Add(t);
  156. e.Add(s);
  157. e.Situation =  "要地震了！！！"  ;
  158. e.Warn();
  159.   160. Console.Read();
  161. }
  162.   163. }
  164. }
  165.
