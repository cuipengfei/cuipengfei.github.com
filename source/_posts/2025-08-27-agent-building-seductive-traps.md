---
title: "Agent 构建中的三个诱人陷阱"
date: 2025-08-27 10:00:00 +0800
tags: [AI Agent, Multi-Agent, RAG, Prompt Engineering, Cline]
---

> 在 Cline 构建 AI agent 的过程中，我们发现最危险的想法不是那些显而易见的坏主意，而是那些在理论上听起来很棒但在实践中却失败的诱人想法。

## 引言

在 Cline 构建 AI agent 的过程中，我们发现最危险的想法不是那些显而易见的坏主意，而是那些在理论上听起来很棒但在实践中却失败的诱人想法。这些"思维病毒"已经感染了整个行业，浪费了数百万工程时间，并将团队引向架构死胡同。

以下是我们看到团队陷入的三个最普遍的陷阱：

1. **Multi-Agent Orchestration**（多智能体编排）
2. **RAG (Retrieval Augmented Generation)** 通过索引代码库
3. **更多指令 = 更好结果**

让我们来探讨原因！

---

## (1) Multi-Agent Orchestration

那种科幻般的 agent 愿景（'后勤 agent、分片 agent、分析器 agent、编排器 agent'）派出一群子 agent 并组合它们的结果听起来很有吸引力，但实际上，大多数有用的 agent 工作都是单线程的。

迄今为止，多智能体系统的最强进展来自 Anthropic，但即使他们也承认构建和对齐多个 agent 是[极其困难的](https://www.anthropic.com/engineering/multi-agent-research-system)。正如他们团队所说：

_"Agent 系统中错误的复合性质意味着传统软件的小问题可能会完全使 agent 脱轨。一个步骤的失败可能导致 agent 探索完全不同的轨迹，从而产生不可预测的结果。由于本文描述的所有原因，原型和生产之间的差距往往比预期的要大。"_

这并不是说我们完全反对多 agent，对于小的特定用例，完全可以使用具有有限工具能力的子 agent。

例如，主 agent 线程生成几个子 agent 并行读取文件的情况。或者，你可能会使用子 agent 执行像从网络获取数据这样的琐碎任务。但这些大部分本质上与进行并行工具调用相同，所以我甚至不确定这是否符合"真正的"多智能体编排。

---

## (2) RAG (Retrieval Augmented Generation)

RAG 是另一个诱人的陷阱，延续自上下文窗口较小的时代，当时给你的 agent 查询"整个代码库"的能力感觉很诱人。但 RAG 的炒作并没有转化为实际的编码 agent 工作流，因为它经常产生分散的代码，而没有为模型提供任何真正的"上下文理解"。它在纸面上看起来很强大，但在实践中，即使是像 GREP 这样简单的东西也能工作得更好，特别是对于 agent。

agent 列出文件、用 grep 搜索它们，然后打开并阅读整个文件，就像人类会做的那样，这几乎总是更好的。Cline 从一开始就设定了这种方法的标准，并且此后定义了元标准，Amp Code 和 Cursor 都跟随了这种做法。

**RAG 和简单/复杂 RAG 介绍**

大多数公司一开始使用向量数据库，因为当"与代码聊天"的 VS Code 扩展在 2023 年首次出现时，模型只有 8,092 个 token 的上下文窗口，所以挤进模型的每一行都必须精心制作。当时这很有意义，这就是为什么这么多基础设施和炒作进入了向量数据库公司，有些筹集了数亿美元，比如 [Pinecone](https://www.pinecone.io/)。Cline 于 2024 年 7 月发布，当时领先的编码模型是具有 200K token 上下文窗口的 Claude 3.5 Sonnet，所以它从来没有受到需要拼接不相关上下文片段的限制。

---

## (3) 更多指令 = 更好结果

认为在系统提示中堆叠越来越多的"指令"会让模型更聪明的神话是完全错误的。过载提示只会混淆模型，因为额外的指令经常冲突并产生噪音。你最终会在行为上打地鼠，而不是获得有用的输出。对于今天的大多数前沿模型，最好退一步让它们工作，而不是通过提示不断对它们吼叫。仔细衡量你的用词。

**信号 vs. 噪声**

当 Cline 在 2024 年中期发布时，Sonnet 3.5 是领先的模型，当时用示例和想法填充提示是有意义的。但当 Sonnet 4 系列到来时，这种方法完全失效了，其他所有 agent 系统也随之失效。通过迭代，我们意识到核心问题：太多指令会产生矛盾，而矛盾会产生混淆。

新的前沿模型，Claude 4、Gemini 2.5 和 GPT-5，在遵循简洁指令方面要好得多。它们不需要文章，它们需要最少的内容。这就是新现实。

---

## 结论

多智能体编排、RAG 和过度填充的提示在纸面上看起来很有吸引力，但没有一个能在真正的开发工作流中幸存下来。获胜的 agent 是那些拥抱简单性的：像开发者一样阅读代码，信任模型的能力，并让开路。

虽然行业继续追逐架构复杂性，但基本面已经发生了转变。少即是多，清晰胜过聪明，最好的 AI agent 往往是最简单的。

**— Ara**

_将你的工程团队转变为具有完全协作的 AI 伙伴。开源、完全可扩展，旨在放大开发者影响力。_

---

> 原文链接：[3 Seductive Traps in Agent Building](https://cline.bot/blog/3-seductive-traps-in-agent-building)  
> 作者：Ara Khan (@arafatkkatze)  
> 发布日期：2025 年 8 月 26 日
